{%- include global_variables.html -%}

<div class="w-100">
  <div class="container-fluid">
    <nav class="navbar navbar-dark navbar-expand-lg background-gray-dark row row-cols-1 row-cols-lg-3">
      <button class="navbar-toggler" type="button" aria-label="{{ t.navbar.label }}">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="order-lg-1 col collapse navbar-collapse">
        <div class="navbar-nav d-flex align-items-center">
          <div class="nav-item w-100 w-lg-auto">
            <a class="nav-link text-uppercase font-weight-bold h6 mb-0 white" href="{{ '/' | relative_url }}">
              {{ t.navbar.home }}
            </a>
          </div>

          {% comment %}
            Generate dropdown menus recursively
          {% endcomment %}
          {% for layout in site.book_layouts -%}
            {% assign posts = site.posts | where: 'layout', layout %}
            {% if posts == empty %}{% continue %}{% endif %}
            <div class="nav-item w-100 w-lg-auto">
              <div class="nav-link dropdown">
                <button
                  class="dropdown-toggle border-0 background-gray-dark white text-uppercase font-weight-bold h6 mb-0"
                  type="button"
                  id="dropdown-{{ layout }}"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false">
                  {{ t.navbar[layout] }}
                </button>

                <div class="dropdown-menu background-gray-dark" aria-labeledby="dropdown-{{ layout }}">
                  {% for post in posts %}
                    <a class="dropdown-item font-weight-bold white" href="{{ post.url | relative_url }}">{{ post.title }}</a>
                  {% endfor %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      <div class="order-first order-lg-2 col navbar-brand text-uppercase text-center" aria-hidden="true">
        <a href="{{ '/' | relative_url }}" class="h4 white mb-0 text-decoration-none">
          {{ site.title }}
          {{ current_site_modifier | remove: ':' }}
        </a>
      </div>

      <div class="order-lg-3 col text-right">
        <div class="nav-item">
          <div class="nav-link">
            <label
              class="white text-uppercase font-weight-bold h6 mb-0"
              for="search-toggler"
              id="search-label">
              {{ t.navbar.search }}
              <i class="fa fa-fw fa-search" aria-hidden="true"></i>
            </label>

            <input type="checkbox" name="search-toggler" id="search-toggler" class="toggler sr-only" />
            <div class="toggled background-gray-dark p-3 position-fixed top-navbar right-0" aria-labeledby="dropdown-search">
              {% include_cached search.html t=t %}
            </div>
          </div>
        </div>
      </div>
    </nav>
  </div>
</div>
